<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChachChat</title>
  <link rel="icon" href="/favicon.ico" />
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="bg"></div>
  <div class="app">
    <!-- Top bar -->
    <header class="topbar glass">
      <div class="brand">
        <img class="brandLogo" src="/logo.png" alt="ChachChat logo" onerror="this.style.display='none'"/>
        <div class="brandText">
          <div class="brandTitle">ChachChat</div>
          <div class="brandSub">Realtime chat • no refresh needed</div>
        </div>
      </div>

      <div class="topActions">
        <div class="status">
          <span class="dot" id="statusDot"></span>
          <span id="statusText">Disconnected</span>
        </div>
        <div class="userpill" id="userPill" hidden>
          <span class="userLabel">You:</span>
          <span class="userName" id="meName"></span>
        </div>
        <button class="btn ghost" id="logoutBtn" hidden>Log out</button>
      </div>
    </header>

    <main class="layout">
      <!-- Chat -->
      <section class="card glass chatCard">
        <div class="cardHeader">
          <h2>Chat</h2>
          <div class="muted" id="roomHint">Everyone in the same room</div>
        </div>

        <div class="messages" id="messages"></div>

        <form class="composer" id="composer">
          <input id="messageInput" class="input" type="text" placeholder="Type a message…" autocomplete="off" maxlength="500" />
          <button class="btn primary" type="submit">Send</button>
        </form>
        <div class="tiny muted">Tip: press Enter to send</div>
      </section>

      <!-- Side -->
      <aside class="card glass sideCard">
        <h3>Rules</h3>
        <ul class="rules">
          <li>Be respectful.</li>
          <li>Username + password required.</li>
          <li>Chat updates live for everyone.</li>
        </ul>
        <div class="tiny muted">
          Messages are stored in SQLite. If you redeploy without a persistent volume, history may reset.
        </div>
      </aside>
    </main>
  </div>

  <!-- Login modal -->
  <div class="modalWrap" id="authModal" aria-hidden="true">
    <div class="modal glass" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <img class="modalLogo" src="/logo.png" alt="ChachChat logo" onerror="this.style.display='none'"/>
        <div>
          <div class="modalTitle">Welcome to ChachChat</div>
          <div class="modalSub">Create an account or sign in to chat</div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" id="tabSignIn" type="button">Sign in</button>
        <button class="tab" id="tabCreate" type="button">Create account</button>
      </div>

      <div class="alert" id="authAlert" hidden></div>

      <div class="field">
        <label>Username</label>
        <input class="input" id="authUsername" type="text" placeholder="e.g., Kyle" autocomplete="username" />
      </div>
      <div class="field">
        <label>Password</label>
        <input class="input" id="authPassword" type="password" placeholder="Your password" autocomplete="current-password" />
      </div>

      <button class="btn primary full" id="authSubmit">Sign in</button>

      <div class="tiny muted">
        Username: 2–24 chars (letters, numbers, spaces, _ . -). Password: 4–64 chars.
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/client.js"></script>
</body>
</html>
